%! TeX program = xelatex
%! lang = en-US
\documentclass[tikz]{standalone}

\usepackage{amsfonts}
\usepackage{amssymb}
\input{../globals/packages}
\input{../globals/colorscheme}
\input{../globals/macros}
\input{../globals/knowledges.kl}
\input{../globals/mathdefs}

\begin{document}
\begin{tikzpicture}[
    cls/.style={minimum width=2cm, minimum height=1cm},
    axis/.style={
        ->,
    },
    decidable/.style={
        thick, Prune, double, ->,
        postaction={
            decorate,
            decoration={markings,
                        mark=at position 0.5 with {\node[midway,above=0.2cm,sloped]{decidable};}
            }
        }
    },
    inclusion/.style={
        dashed,
        thick,
        Prune,
        ->,
        postaction={
            decorate,
            decoration={markings,
                        mark=at position 0.5 with {\node[midway,above,sloped]{?};}
            }
        }
    },
    group/.style={
        draw, thick,
        rounded corners=3mm,
        opacity=0.05,
    },
    polygrowth/.style={
        fill=D4,
    },
    starfree/.style={
        fill=D5,
    },
    zoutput/.style={
        fill=D2,
    },
    noutput/.style={
        fill=D3,
    }
    ]
    \node[cls] (SF)  at (0,  0) {$\SF$};
    \node[cls] (P)   at (4,  0) {$\Poly$};
    \node[cls] (ZSF) at (0, -3) {$\ZSF$};
    \node[cls] (NSF) at (0, -6) {$\NSF$};
    \node[cls] (ZP)  at (4, -3) {$\ZPoly$};
    \node[cls] (NP)  at (4, -6) {$\NPoly$};
    \node[cls] (ZR)  at (8, -3) {$\ZRat$};
    \node[cls] (NR)  at (8, -6) {$\NRat$};

    \draw[decidable] (ZSF) to (ZP);
    \draw[decidable] (ZP) to (ZR);
    \draw[decidable] (NP) to (NR);
    \draw[decidable] (ZP) to (P);
    \draw[decidable] (ZSF) to (SF);

    \draw[inclusion] (NP) to (ZP);
    \draw[inclusion] (NSF) to (ZSF);
    \draw[inclusion] (NR) to (ZR);
    \draw[inclusion] (SF) to (P);
    \draw[inclusion] (NSF) to (NP);

    \draw[axis] (-1,-6.5) -- 
        node[midway, below] {Computational power}
        (9,-6.5);
    \draw[axis] (-1,-6.5) -- 
        node[midway, above, rotate=90] {Output alphabet}
        (-1,0.5);

    \begin{scope}[on background layer]
        % Big groups
        %polynomial growth
        \draw[group,polygrowth] (SF.north west) rectangle ($(NP.south east)!0.5!(NR.south west)$);
        %commutative output
        \draw[group,zoutput] ($(ZSF.north west)!0.5!(SF.south west)$) rectangle (NR.south east);

        % Small groups
        % star-free
        \draw[group,starfree] (SF.north west) rectangle ($(NSF.south east)!0.5!(NP.south west)$);
        % N-defined
        \draw[group,noutput] ($(NSF.north west)!0.5!(ZSF.south west)$) rectangle (NR.south east);
    \end{scope}
\end{tikzpicture}
\end{document}

