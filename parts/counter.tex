%! TeX program = xelatex
%! lang = en-US
\section{$\Nat$-rational Polynomials}
\label{polynomials:sec}
%\subsection{The counter example}
\label{sec:c-example}

\AP A polynomial $P \in \Rel[X_1, \dots, X_n]$ is an \intro{$\Nat$-rational
polynomial} if it is \kl{represented} by a \kl{$\Nat$-polyregular function}.
The analogue notion of \intro{$\Rel$-rational polynomials} is not of particular
interest, since every polynomial $P$ is \kl{represented} by a
\kl{$\Rel$-polyregular function}. It is an easy check that polynomials with
coefficients in $\Nat$ are \kl{$\Nat$-rational polynomials}
(\cref{n-poly-n-poly:example}). However, \cref{negative-but-npoly:ex} provides
a polynomial with negative coefficients that is an \kl{$\Nat$-rational
polynomial}. As a consequence, the class of interest strictly contains
$\Nat[\vec{X}]$.

\begin{lemma}
    \label{n-poly-n-poly:example}
    Let $P \in \Nat[\vec{X}]$. Then, $P$
    is an \kl{$\Nat$-rational polynomial}.
    \proofref{n-poly-n-poly:example}
\end{lemma}

\begin{example}
    \label{negative-not-nrat:ex}
    \label{negative-but-npoly:ex}
    The polynomials $X$, $X^2 + 3$,
    and $X^2 - 2X + 2$
    are \kl{$\Nat$-rational polynomials},
    but $- X$ is a \kl{$\Rel$-rational polynomial} that is 
    not an \kl{$\Nat$-rational polynomial}.
    \proofref{negative-not-nrat:ex}
\end{example}


The goal of this section is to provide semantic characterizations of
\kl{$\Nat$-rational polynomials}, decide if a polynomial $P$ is an
\kl{$\Nat$-rational polynomial}, and if so, explicitly compute an
\kl{$\Nat$-polyregular function} $f$ that \kl{represents} $P$. To that end, let
us now introduce the characterization of \kl{$\Nat$-rational polynomials} given
by \cite{KARH77}, which is stated using a class $\CoveredPoly[\vec{X}]$ of
polynomials with multiple indeterminates.

\begin{definition}[{\cite[Section 3, page 3]{KARH77}}]
    Let $\vec{X}$ be a finite tuple of indeterminates.
    The class $\intro*\CoveredPoly[\vec{X}]$
    is the class of polynomials $P \in \Rel[\vec{X}]$
    that are \kl{non-negative}
    and such that every \kl{maximal monomial} is \kl{non-negative}.
    When the indeterminates are clear from the context, we write
    this class $\reintro*\CoveredPoly$.
\end{definition}

\begin{faketheorem}[{\cite[Theorem 3.3, page 4]{KARH77}}] 
    \label{karh:thm}
    Let $\Sigma$ be a finite alphabet
    and $P$ be a polynomial. Then,
    $P$ is an \kl{$\Nat$-rational polynomial}
    if and only if 
    $P \in \CoveredPoly$.
\end{faketheorem}

To understand why \cref{karh:thm} is false, we need to understand why some
non-negative polynomials are not \kl{$\Nat$-rational polynomials}, which is
illustrated by \cref{non-neg-not-nrat:ex}. 

\begin{fact}
    \label{pre-image-regular:fact}
    The pre-image of a regular language by an \kl{$\Nat$-rational series}
    is a regular language. 
\end{fact}

\begin{example}
    \label{non-neg-not-nrat:ex}
    Let $P(X, Y) \defined (X - Y)^2$.
    Then $P$ is
    is \kl{non-negative}, but is
    not an \kl{$\Nat$-rational polynomial}.
\end{example}
\begin{proof}
    Assume by contradiction that
    $f \in \NPoly$ \kl{represents} $f$ over the alphabet $\Sigma \defined \set{a,b}$.
    Then, $f^{-1}(\set{0})$ is a regular language
    (\cref{pre-image-regular:fact}),
    but $S^{-1}(\set{0}) = \setof{ w \in \Sigma }{ \card[a]{w} = \card[b]{w} }$
    is not.
\end{proof}


Let us now design a counter example to \cref{karh:thm} by suitably tweaking
\cref{non-neg-not-nrat:ex} to ensure that the polynomial not only is
\kl{non-negative}, but also belongs to $\CoveredPoly$.

\begin{definition}
    \label{def:bad-polynomial}
    We define $\intro*\BadPoly(X,Y,Z) \defined Z (X + Y)^2 + 2 (X - Y)^2$.
\end{definition}

\begin{lemma}
    \label{thm:counter-example}
    The polynomial $\BadPoly$ belongs to $\CoveredPoly$,
    but is not an \kl{$\Nat$-rational polynomial}.
    As a corollary, 
    the result stated in \cite[Theorem 3.3]{KARH77}, restated
    in \cref{karh:thm}, is false
    when allowing at least $3$ indeterminates.
\end{lemma}
