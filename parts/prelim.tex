%! TeX program = xelatex
%! lang = en-US
\section{Preliminaries}
\label{preliminaries:sec}

\AP In the rest of this paper, $\Rel$ (resp. $\Nat$) denotes the set of
integers (resp. non-negative integers). The capital letters $\Sigma,\Gamma$
denotes fixed alphabets, i.e. a finite set of letters, and $\Sigma^*, \Gamma^*$
(resp. $\Sigma^+, \Gamma^+$) are the set of words (resp. non-empty words) over
$\Sigma, \Gamma$. The empty word is written $\varepsilon \in \Sigma^*$. When $w
\in \Sigma^*$ and $a \in \Sigma$, we let $\card{w} \in \Nat$ be the length of
$w$, and $\card[a]{w}$ be the number of occurrences of $a$ in $w$. We assume
that the reader is familiar with the basics of automata theory, in particular
the notions of monoid morphisms, idempotents in monoids, monadic second-order
($\MSO$) logic and first-order ($\FO$) logic over finite words (see e.g.
\cite{THOM97}). As aperiodicity will be a central notion of this paper, let us
recall that a monoid $M$ is \intro(monoid){aperiodic} whenever for all $x \in
M$, there exists $n \in \Nat$ such that $x^{n+1} = x^n$.

\AP We also assume the reader to be familiar with \kl{rational series} and
weighted automata, and refer to \cite{BERE10} for a comprehensive introduction.
Let us recall that one of the equivalent definitions of a $K$-rational series
(where $K$ is a ring) is given by the functions from $\Sigma^*$ to $K$ computed
by weighted automata, which are non-deterministic finite automata with
transitions labelled by elements of $K$, and whose output on a given word is
the sum over all accepting paths of the products of the weights along the path.

\AP We use the notation $\commute \colon \Sigma^* \to \Nat^\Sigma$ for the map
that counts occurrences of every letter in the input word (that is, computes
the Parikh vector) namely: $ \commute[w] \defined (a \mapsto \card[a]{w})$.
Given a set $X$, a function $f \colon \Sigma^* \to X$ is \intro{commutative}
whenever for all $u \in \Sigma^*$, for all permutations $\sigma$ of $\set{1,
\dots, \card{w}}$, $f(\sigma(u)) = f(u)$. Equivalently, it is
\reintro{commutative} whenever there exists a map $g \colon \Nat^\Sigma \to X$
such that $g \circ \commute = f$. A function $g \colon \Nat^n \to X$ is
\intro{represented} by a function $f \colon \Sigma^* \to X$ if there exists a
map $\eta \colon \set{1, \dots, n} \to \Sigma$ such that $g \circ (v \colon
\Nat^\Sigma \mapsto \seqof{v(\eta(k))}{1 \leq k \leq n} \colon \Nat^n) \circ
\commute = f$. This notion will be useful to formally state that a polynomial
``is'' a \kl{polyregular function}.

\subsection{Polyregular Functions}

\AP Because the functions of interest in this paper have output in $\Nat$ or
$\Rel$, we will only provide the definition of \kl{polyregular functions} for
these two output semigroups, and we refer the reader to \cite{BOKL19} for the
general definition of \kl{polyregular functions}. As a model of computation, we
will use the following definition of transducers, that is based on the marble
transducers \cite{EHB99}, and follows the general pattern of transducers
introduced in \cite{CDTL23}. Note that we only consider $\Rel$-valued (resp.
$\Nat$-valued) functions, but could consider other commutative semigroups.

\begin{definition}
    Let $\mathcal{H}$ be a family of functions
    from $\Sigma^*$ to $\Rel$.
    An \intro{$\mathcal{H}$-transducer} $\aTransd$ is
    a tuple $(Q, q_0, \delta, \lambda, F)$ where
         $Q$ is a finite set of states,
         $q_0 \in Q$ is an initial state,
         $\delta \colon Q \times \Sigma \to Q$
            is a deterministic transition function,
         $\lambda \colon Q \times \Sigma \to \mathcal{H}$
            is a correction function,
         and $F \colon Q \to \Rel$ is an output function.
\end{definition}

\begin{definition}
    Let $\aTransd \defined (Q,q_0, \delta, \lambda, F)$ be an \kl{$\mathcal{H}$-transducer}.
    The function
    $\aTransd \colon Q \times \Sigma^* \to \Rel$
    is defined inductively as follows:
        $\aTransd(q, \varepsilon) \defined F(q)$, and
        $\aTransd(q, a u) \defined \aTransd(\delta(q,a), u)
            + \lambda(q,a)(u)$.
    The function \intro{computed} by a transducer $\aTransd$
    is $w \mapsto \aTransd(q_0, w)$.
\end{definition}

\AP Let us recall that a \intro{counter} in an automaton is a pair $u,w$ of
words together with an integer $n > 1$, such that $\delta(q_0, uw^n) =
\delta(q_0, u)$ and $\delta(q_0, u w^k) \neq \delta(q_0, u)$ for all $k < n$;
where we used the extension of $\delta \colon Q \times \Sigma \to Q$ to words
by defining $\delta(q, \varepsilon) = q$, and $\delta(q,au) =
\delta(\delta(q,a), u)$. An automaton is \reintro{counter-free} if it contains
no \reintro{counters}. This notion can be lifted to
\kl{$\mathcal{H}$-transducers} by considering counters of their underlying
automata. 

\AP The notion of \kl{$\mathcal{H}$-transducer} can be used to inductively
define the classes $\intro*\NPoly[k]$, $\intro*\NSF[k]$, $\intro*\ZPoly[k]$ and
$\intro*\ZSF[k]$ as follows \cite[Theorems 5.15 and 7.10]{DOUE23}: in the base
case, $\reintro*\NPoly[-1] = \reintro*\NSF[-1]  = \reintro*\ZSF[-1] =
\reintro*\ZPoly[-1]$ is the singleton containing the constant function equal to
$0$; and for $k \geq 0$, $\reintro*\ZPoly[k]$ is the set of functions
\kl{computed} by a \kl{$\reintro*\ZPoly[k-1]$-transducer}, and
$\reintro*\NPoly[k]$ is the set of functions \kl{computed} by an
\kl{$\reintro*\NPoly[k-1]$-transducer} \emph{with an $\Nat$-valued output
function $F$}, and similarly for $\reintro*\NSF[k]$ and $\reintro*\ZSF[k]$,
where the transducer is furthermore required to be \kl{counter-free}. Then,
$\reintro*\NPoly = \bigcup_{k \in \Nat} \reintro*\NPoly[k]$, and classes
$\reintro*\NSF$, $\reintro*\ZPoly$ and $\reintro*\ZSF$ are defined similarly.
In the rest of the paper, we will always assume that
\kl{$\reintro*\NPoly[k]$-transducers} and \kl{$\reintro*\NSF[k]$-transducers}
have an $\Nat$-valued output functions, making a clean separation between
$\NPoly$ and $\ZPoly$.

\begin{example}
    \label{non-canonical-transd:ex}
    Let $\BadExOk \colon \set{a}^* \to \Nat$
    be defined as
    $\BadExOk(\varepsilon) = 1$,
    $\BadExOk(a) = 0$,
    and $\BadExOk(a^n) = n - 1$ for all $n \geq 2$.
    The function $\BadExOk$ is \kl{computed} by the two \kl{$\NPoly[0]$-transducers}
    depicted in \cref{non-canonical-transd:fig}.
\end{example}


\begin{figure}
    \centering
    \begin{subfigure}[b]{0.49\linewidth}
        \begin{tikzpicture}[
            etat/.style={minimum size=2em}
            ]
            \node[etat,state,initial,
                accepting by arrow,
                accepting text={$1$},
                accepting where=below,
                ] (A) at (0,0) {$\varepsilon$};
            \node[etat,state,
                accepting by arrow,
                accepting text={$0$},
                accepting where=below,
                ] (B) at (2,0) {$a$};

            \draw[->] (A) to node[midway, below] {$a \mid 0$} (B);

            \draw[->] (B) to[bend right=45] node[midway, above] {$a \mid 1 + \ind{\card{w} \geq 1}$} (A);
        \end{tikzpicture}
        \caption{This automaton has a \kl{counter}.}
    \end{subfigure}
    \begin{subfigure}[b]{0.49\linewidth}
        \begin{tikzpicture}[
            etat/.style={minimum size=2em}
            ]
            \node[etat,state,initial,
                accepting by arrow,
                accepting text={$1$},
                accepting where=below,
                ] (A) at (0,0) {$\varepsilon$};
            \node[etat,state,
                accepting by arrow,
                accepting text={$0$},
                accepting where=below,
                ] (B) at (2,0) {$a$};

            \draw[->] (A) to node[midway, below] {$a \mid 0$} (B);

            \draw[->] (B) edge[loop right] node[midway, right]
                {$a \mid 1 + \ind{\card{w} = 0}$} (B);
        \end{tikzpicture}
        \caption{This automaton is \kl{counter-free}.}
    \end{subfigure}
    \caption{Two \kl{$\NPoly[0]$-transducers}
    \kl{computing} the function $\BadExOk$ of \cref{non-canonical-transd:ex}.}
    \label{non-canonical-transd:fig}
\end{figure}


\AP One of the appeals of $\NPoly$ and $\ZPoly$ are the numerous
characterizations of these classes in terms of logic, weighted automata, and
the larger class of \kl{polyregular functions} \cite{CDTL23,DOUE23}. In this
paper, the main focus will be the connection to weighted automata, which is
based on the notion of \emph{growth rate}. The \intro{growth rate} of a
function $f \colon \Sigma^* \to \Rel$ is defined as the minimal $k$ such that
$\card{f(w)} = \bigO\left(\card{w}^k\right)$. If such a $k$ exists, we say that
the function $f$ has \intro{polynomial growth}. It turns out that for all $k
\in \Nat$, $\ZPoly[k]$ (resp. $\NPoly[k]$) are precisely functions in $\ZRat$
(resp. in $\NRat)$ that have growth rate at most $k$. Not all
\kl{$\Nat$-rational series} have \kl{polynomial growth}, a typical example
being the function $a^n \mapsto 2^n$.

Let us briefly state that \kl{commutativity} is a decidable property of
\kl{$\Rel$-rational series}, hence of \kl{$\Rel$-polyregular functions}.

\begin{lemma}
    \label{decidable-commutative-poly:lemma}
    \label{decidable-commutative-rat:lemma}
    Let $f \in \ZRat$. One can decide if 
    $f$
    is \kl{commutative}.
\end{lemma}

\subsection{Polynomials} 
\AP All polynomials considered in this paper have
coefficients in $\Rel$ unless explicitly stated otherwise. 
A polynomial $P \in \Rel[X_1, \dots, X_k]$ is \intro{non-negative} when for
all non-negative integer inputs $n_1, \dots, n_k \geq 0$, the output  $P(n_1,
\dots, n_k)$ of the polynomial is non-negative. Beware that we do not consider
negative values as input, as the numbers $n_i$ will ultimately count the number
of occurrences of a letter in a word. As an example, the polynomial $(X - Y)^2$
is \kl{non-negative}, and so is the polynomial $X^3$, but the polynomial $X^2 -
2X$ is not.

\AP Let us now give some vocabulary on polynomials with multiple indeterminates
over $\Rel$. A \intro{monomial} is a product of indeterminates and integers.
For instance, $XY$ is a \kl{monomial}, $3 X$ is a \kl{monomial}, $-Y$ is a
\kl{monomial}, but $X + Y$ or $2X^2 + XY$ are not. We write $\intro*\Monomials[X_1,
\dots, X_n]$ for the set of \kl{monomials} over these indeterminates.
Every polynomial $P \in \Rel[X_1, \dots, X_n]$ decomposes uniquely
into a sum of \kl{monomials}.

\AP A \kl{monomial} $S$ \intro{divides} a \kl{monomial} $T$, when $S$ divides
$T$ seen as polynomials in $\Rat$. For instance, $2X$ \kl{divides} $XY$, $-YZ$
\kl{divides} $X^2 Y Z^3$, and $Y$ does not \kl{divide} $X$. In the
decomposition of $P \in \Rel[X_1, \dots, X_k]$, a \kl{monomial} is a
\intro{maximal monomial} if it is a maximal element for the \kl{divisibility
ordering} of \kl{monomials}. In the polynomial $P(X,Y) \defined X^2 - 2XY + Y^2
+ X + Y$, the set of \reintro{maximal monomials}, written
$\intro*\MaximalMonomials(P)$, is $\set{X^2,  -2 XY,  Y^2}$.  In the polynomial
$P(X,Y) \defined (X - Y)^2$, the \kl{non-negative} \kl{monomials} are $X^2$ and
$Y^2$.
